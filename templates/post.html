{% extends "layout.html" %} {% block header %}
<title>{{ post[1] }} - {{ websiteName }}</title>
<!-- @author : Giridhari -->
<meta name="description" content="{{ post[3] }}">
<script>
function checkIfSure () {
var sure = confirm("Are you sure you want to delete the post?");
if (sure == true) {
    window.location.assign("{{ url_for('postdelete', posturl=post[2]) }}");
}}
</script>

<script type="text/javascript">
  function extractComment(){
    comment = $('#comment').val();
    var content = "<p><b>Admin : </b>"+comment+"</p>";
    var content2 = "<p><b>Anonymous : </b>"+comment+"</p>";
    $.ajax({
      url:'/submit.comment/{{ post[2] }}',
      method: 'POST',
      data: { comment:comment },
      success: function (result) {
        if (result=="0") {
          $('#commetnDiv').append(content2);
        }
        else{
          $('#commetnDiv').append(content);
        }
      }  
    });
}
</script>
{% endblock %}

{% block content %}
<div class="single-post">

  <a href="{{ currentUrl }}">
    <h2>{{ post[1] }}</h2>
  </a>

  <div class="post-meta">
    <p><b><i class="fa fa-calendar"></i></b> {{ post[5] }} - <b><i class="fa fa-user"></i> </b>{{ user[0] }}</p>
  </div>

  <p>{{ post[3]|safe }}</p>

</div>


<div class="post-footer">
  <p>
     {% if session.logged_in and session['userid'] == post[4]|int %}
       <a class="button" href="{{ url_for('postedit', posturl=post[2]) }}"><i class="fa fa-edit"></i> Edit</a></li>
        -
        <a class="button" onclick="checkIfSure()"><i class="fa fa-times"></i> Delete</a>
     {% endif %}</p>
</div>
<div>
  <p><b>{{ comment|length }} Comments</b></p>
  <hr>
  <div id="commetnDiv">
    {% for data in comment %}
    <p><b>{% if not data.userid|int == 0 %}
            Admin
          {% else %} 
            Anonymous 
          {% endif %}
    :</b> {{data.comment}}</p>
    {% else %}
    <p>No Comment! Be the first to comment.</p>
    {% endfor %}
  </div>
  <hr>
  <p>Add Comment:</p>
  <div class="formContainer">
  <!-- <form> -->
    <input style="padding: 12px 20px;margin: 8px 0;display: inline-block;border: 1px solid #ccc;border-radius: 4px;box-sizing: border-box;" type=text id="comment" name="comment" placeholder="Start the discussion..."></input>
    <button onclick="extractComment()">Add Comment</button>
  <!-- </form> -->
  </div>
  <hr>

</div>
{% endblock %}
